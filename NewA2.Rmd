---
title: "Assignment 2"
author: "Joyce Lee"
output: 
  bookdown::html_document2: default
keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", fig.path = "Figures/")
```

```{r, message=FALSE}
library(bookdown)
library(tidyverse)
library(readr)
library(kableExtra)
library(ggplot2)
library(lubridate)
library(gridExtra)
library(dplyr)
library(knitr)
```

# Introduction 
Yellowstone National Park has always been a popular attraction where it attracted approximately 4.02 million of visitors last year (Lock, 2020). Its tremendous popularity is inseparable from the well-known geysers as watching the eruptions of geysers has been treated as a "must" for visitors. Yet among nearly 500 geyers located in Yellowstone National Park, a number of geysers are much more notable among others. Old Faithful Geyser occupies one of these places. Signified with its name, Old Faithful Geyser is "faithful" for the reason that its eruption time has been more predictable, with its steady regularity of eruptions.

Nature is changing dynamically. As a part of nature, researches have been conducted to present changes of Old Faithful Geyser. In particular, O'Hara and Esawi (2013) has revealed the fact that the waiting time between eruptions has gradually prolonged from year to year. The question that whether the duration of eruption would also be compressed due to extended waiting time will be delved in in this report.

# Exploratory Data Analysis
The dataset used in this report is from R package, "faithful". It records 272 observations of both eruptions and waiting time of Old Faithful Geyser, as shown in Table \@ref(tab:table1).

```{r}
dat <- datasets::faithful
glimpse(dat)
```

```{r}
save(dat, file = "dat")
```

```{r table1}
table1 <- dat %>%
  knitr::kable(caption = "Table 1 - Eruption Duration and Waiting Times")
table1
```

```{r}
summary_table <- dat %>%
  dplyr::select(waiting) %>%
  summary()

summary_table
```

Table 2 \@ref(fig:table2)) and its relative boxplot Figure \@ref(fig:Figure1)) present the overall distribution of waiting time between eruptions. According to O'Hara and Esawi (2013), the mean eruption interval was 64 minutes in 1948. It turned out to be ~80 minutes in 1979 and ~92 minutes in 2011. The mean waiting time of "faithful" dataset is 70.9, which suggests this dataset might be obtained between 1948 and 1979.

```{r table2}
table2 <- dat %>% 
  dplyr::select(waiting) %>%
  summary() %>%
  knitr::kable(caption = "Table 2 - Summary Statistics for Waiting Time")

table2
```

```{r Figure1, fig.cap="Boxplot of waiting time", include=TRUE }
figure1 <- 
dat %>%
  dplyr::select(waiting) %>%
  ggplot(aes(x = waiting)) +
  geom_boxplot()

figure1
```

Although we assume this dataset as a quite early collection of data, it does not restrict the study of the relationship between eruption duration and waiting time.

```{r Figure2, fig.cap="Plot of waiting time against eruptions", include=TRUE}
figure2 <- ggplot(dat) +
  geom_point(mapping = aes(x = waiting, y = eruptions))

figure2
```

This plot Figure \@ref(fig:Figure2) with waiting time as the x-axis and eruptions as the y-axis displays the pattern between eruption duration and waiting time. It exhibits the tendency of distribution generated by the variables.

# Conclusion
The assumption that this dataset from "Faithful" package is acquired between 1948 and 1979 has partially restrained our ability to respond to the hypothesis comprehensively. The uncertainty of the time of this dataset hinders us to outlook the performance for generating a more complete picture with more recent data for the long run. Apart from that, the trend which longer waiting time leads to longer duration of eruptions illustrates our hypothsis that the duration of eruptions is unlikely to be reduced.

# Reference
Lock, S. (2020). Number of visitors to Yellowstone National Park in the U.S. 2008-2019. Retrieved from https://www.statista.com/statistics/254231/number-of-visitors-to-the-yellowstone-national-park-in-the-us/

Oâ€™Hara, K. D., & Esawi, E.K. (2013). Model for the eruption of the Old Faithful geyser,
Yellowstone National Park. *GSA Today*, 23(6), 4-9. doi: 10.1130/GSATG166A.1

